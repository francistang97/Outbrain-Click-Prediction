{"paragraphs":[{"text":"%md\n# Hadoop Related Data Exploration\n\n#### In this Zeppelin Notebook, we will use Hadoop to solve and explore more about the datasets. Hive and Spark will be used.","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Hadoop Related Data Exploration</h1>\n<h4>In this Zeppelin Notebook, we will use Hadoop to solve and explore more about the datasets. Hive and Spark will be used.</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225729205_1315808406","id":"20171017-142251_1776896470","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6992"},{"text":"%md\n## Import Data into Spark DataFrames\nAs the 88GB data is too huge for pyspark to handle, we will simply use the smaller sample one here first.","user":"student4","dateUpdated":"2017-10-17T20:38:15+1300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Import Data into Spark DataFrames</h2>\n<p>As the 88GB data is too huge for pyspark to handle, we will simply use the smaller sample one here first.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225729206_1316962652","id":"20171017-142321_1643745969","dateCreated":"2017-10-17T20:35:29+1300","dateStarted":"2017-10-17T20:38:15+1300","dateFinished":"2017-10-17T20:38:15+1300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6993"},{"text":"%md\n#### Firstly, we will load page_views_sample dataset here:\nWe will perform a groupby to group all the same document_id together to find out which document got the most clicks:","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Firstly, we will load page_views_sample dataset here:</h4>\n<p>We will perform a groupby to group all the same document_id together to find out which document got the most clicks:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225729206_1316962652","id":"20171017-142723_45159811","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6994"},{"text":"%spark2.pyspark\npage_views_df = sqlContext.read.format(\"csv\").option(\"header\", \"true\").option(\"inferSchema\", \"true\").load(\"/user/tsusnjak/assignment3Datasets/page_views_sample.csv\")\npage_views_df.cache() # Cache page_views_df for faster reuse\npage_views_df = page_views_df.dropna() # drop rows with missing values\npage_views_df.show(20)\npage_views_df.printSchema()","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{"0":{"graph":{"mode":"table","height":718,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+-----------+---------+--------+------------+--------------+\n|          uuid|document_id|timestamp|platform|geo_location|traffic_source|\n+--------------+-----------+---------+--------+------------+--------------+\n|1fd5f051fba643|        120| 31905835|       1|          RS|             2|\n|8557aa9004be3b|        120| 32053104|       1|       VN>44|             2|\n|c351b277a358f0|        120| 54013023|       1|       KR>12|             1|\n|8205775c5387f9|        120| 44196592|       1|       IN>16|             2|\n|9cb0ccd8458371|        120| 65817371|       1|   US>CA>807|             2|\n|2aa611f32875c7|        120| 71495491|       1|       CA>ON|             2|\n|f55a6eaf2b34ab|        120| 73309199|       1|       BR>27|             2|\n|cc01b582c8cbff|        120| 50033577|       1|       CA>BC|             2|\n|6c802978b8dd4d|        120| 66590306|       1|       CA>ON|             2|\n|f4e423314303ff|        120| 48314254|       1|   US>LA>622|             1|\n|3937372ca2709b|        120| 24360074|       1|          NO|             2|\n|31f8d101c6a851|        120| 13847456|       1|       PH>D9|             2|\n|67606983fe1acf|        984| 82129416|       2|   US>OK>671|             2|\n|3f9d5b09ac4a0a|        984| 82583638|       2|          US|             2|\n|3dd8a359aa8699|        984| 59439284|       2|   US>MD>511|             2|\n|95e966c81b9316|        984|   983791|       3|   US>AL>698|             2|\n|483cf1feb3e47c|        984| 17944009|       2|   US>MI>505|             1|\n|f7baf0caf201ca|        984| 37096677|       2|       CA>AB|             2|\n|7a408fe90c02b3|        984| 30457643|       1|          PH|             1|\n|9ee2877617838a|        984| 86093121|       3|   US>MN>613|             2|\n+--------------+-----------+---------+--------+------------+--------------+\nonly showing top 20 rows\n\nroot\n |-- uuid: string (nullable = true)\n |-- document_id: integer (nullable = true)\n |-- timestamp: integer (nullable = true)\n |-- platform: integer (nullable = true)\n |-- geo_location: string (nullable = true)\n |-- traffic_source: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1508225729207_1316577904","id":"20171017-142758_373307424","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6995"},{"text":"%spark2.pyspark\npage_views_by_docid = page_views_df.groupBy('document_id').count().toPandas()\npage_views_by_docid_count = page_views_by_docid.set_index('document_id').sort_index()\npage_views_by_docid_count_sorted = page_views_by_docid_count.sort_values(['count'], ascending =False)\npage_views_by_docid_count_sorted","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"              count\ndocument_id        \n1811567      429551\n234          179692\n42744        156231\n1858440      112140\n1780813      109624\n60164        104941\n1790442       91420\n1877626       80309\n1821895       79956\n732651        74630\n25792         72078\n364356        70274\n1786343       66414\n1860163       64659\n1770064       63370\n1774106       59731\n468335        57584\n1850127       52461\n985671        48049\n1850151       45220\n270496        44588\n1763695       41283\n1819174       40935\n1867736       37956\n1836115       37539\n1841624       36609\n1687259       36583\n1790733       34023\n1801680       33435\n465809        31459\n...             ...\n471420            1\n1225726           1\n1225688           1\n1224905           1\n1572701           1\n1836681           1\n1232344           1\n475297            1\n89303             1\n1234620           1\n1239601           1\n1239495           1\n1239214           1\n1239064           1\n1238942           1\n1238703           1\n1238682           1\n1566391           1\n89794             1\n1236339           1\n1236321           1\n1236288           1\n1235301           1\n1235262           1\n1235204           1\n89572             1\n1567187           1\n1235174           1\n1235163           1\n1342378           1\n\n[59849 rows x 1 columns]\n"}]},"apps":[],"jobName":"paragraph_1508225729207_1316577904","id":"20171017-142832_862097107","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6996"},{"text":"%md\n#### Above is the analysis about the page views by document ID. The sorted data frame was shown above.\n#### Now we will perform a counting function to get the page views by users, the data frame will be shown below:","user":"student4","dateUpdated":"2017-10-17T20:40:38+1300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Above is the analysis about the page views by document ID. The sorted data frame was shown above.</h4>\n<h4>Now we will perform a counting function to get the page views by users, the data frame will be shown below:</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225729208_1314654159","id":"20171017-143129_514521780","dateCreated":"2017-10-17T20:35:29+1300","dateStarted":"2017-10-17T20:40:38+1300","dateFinished":"2017-10-17T20:40:38+1300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6997"},{"text":"%spark2.pyspark\n#Grouping page views by user id and aggregating the count by user\npage_views_by_user_df = page_views_df.groupBy('uuid').count()\n#Grouping page views user counts by counts (to build a histogram)\npage_views_user_distribution_df = page_views_by_user_df.select('count').groupby('count').count()\n#Converting the PySpark Dataframe to a Pandas Dataframe (for plotting)\npage_views_by_user_pandas = page_views_user_distribution_df.toPandas()\npage_views_by_user_pandas.columns = ['UserPageViews', 'UserCounts']\npage_views_by_user_pandas = page_views_by_user_pandas.set_index('UserPageViews').sort_index()\npage_views_by_user_pandas.head(10)","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"               UserCounts\nUserPageViews            \n1                 8546933\n2                  549587\n3                   80770\n4                   16394\n5                    6165\n6                    1453\n7                     479\n8                     247\n9                      90\n10                     22\n"}]},"apps":[],"jobName":"paragraph_1508225729209_1314269410","id":"20171017-143148_136648346","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6998"},{"text":"%spark2.pyspark\npage_views_by_platform_pandas = page_views_df.groupBy('platform').count().toPandas()\npage_views_by_platform_pandas = page_views_by_platform_pandas.set_index('platform').sort_index()\npage_views_by_platform_pandas","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"            count\nplatform         \n1         4403345\n2         4678799\n3          917855\n"}]},"apps":[],"jobName":"paragraph_1508225729209_1314269410","id":"20171017-163917_1560543445","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6999"},{"text":"%md\n#### The page views grouped by different platforms are generated into a dataframe which was shown above\n##### It is said in the intro that platform (desktop = 1, mobile = 2, tablet =3), so we can find out that desktop and mobile are the most popular and mobile is a bit more common used by users.\n\n#### Now we will group page views data with traffic sources. The data frame will be shown below:\n##### Introduction said \"traffic_source (internal = 1, search = 2, social = 3)\", very interesting to see that most of the page views are from internal source while search and social are very close to each other.","user":"student4","dateUpdated":"2017-10-17T20:45:55+1300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>The page views grouped by different platforms are generated into a dataframe which was shown above</h4>\n<h5>It is said in the intro that platform (desktop = 1, mobile = 2, tablet =3), so we can find out that desktop and mobile are the most popular and mobile is a bit more common used by users.</h5>\n<h4>Now we will group page views data with traffic sources. The data frame will be shown below:</h4>\n<h5>Introduction said &ldquo;traffic_source (internal = 1, search = 2, social = 3)&rdquo;, very interesting to see that most of the page views are from internal source while search and social are very close to each other.</h5>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225729210_1315423657","id":"20171017-163927_903116282","dateCreated":"2017-10-17T20:35:29+1300","dateStarted":"2017-10-17T20:45:55+1300","dateFinished":"2017-10-17T20:45:55+1300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7000"},{"text":"%spark2.pyspark\npage_views_by_traffic_source_pandas = page_views_df.groupBy('traffic_source').count().toPandas()\npage_views_by_traffic_source_pandas = page_views_by_traffic_source_pandas.set_index('traffic_source').sort_index()\npage_views_by_traffic_source_pandas","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"                  count\ntraffic_source         \n1               6668961\n2               1667170\n3               1663868\n"}]},"apps":[],"jobName":"paragraph_1508225729210_1315423657","id":"20171017-163934_1558716325","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7001"},{"text":"%md\n## Load events.csv dataset here:","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Load events.csv dataset here:</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225729211_1315038908","id":"20171017-163937_118589629","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7002"},{"text":"%spark2.pyspark\nevents_df = sqlContext.read.format(\"csv\").option(\"header\", \"true\").option(\"inferSchema\", \"true\").load(\"/user/tsusnjak/assignment3Datasets/events.csv\")\nevents_df.cache() # Cache events_df for faster reuse\nevents_df = events_df.dropna() # drop rows with missing values\nevents_df.show(20)\nevents_df.printSchema()","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+--------------+-----------+---------+--------+------------+\n|display_id|          uuid|document_id|timestamp|platform|geo_location|\n+----------+--------------+-----------+---------+--------+------------+\n|         1|cb8c55702adb93|     379743|       61|       3|   US>SC>519|\n|         2|79a85fa78311b9|    1794259|       81|       2|   US>CA>807|\n|         3|822932ce3d8757|    1179111|      182|       2|   US>MI>505|\n|         4|85281d0a49f7ac|    1777797|      234|       2|   US>WV>564|\n|         5|8d0daef4bf5b56|     252458|      338|       2|       SG>00|\n|         6|7765b4faae4ad4|    1773517|      395|       3|   US>OH>510|\n|         7|2cc3f6457d16da|    1149661|      602|       2|   US>MT>762|\n|         8|166fc654d73c98|    1330329|      638|       2|   US>PA>566|\n|         9|9dddccf70f6067|    1772126|      667|       1|   US>FL>528|\n|        10|b09a0e92aa4d17|     157455|      693|       1|          US|\n|        11|602e210c5831e5|    1773230|      710|       3|   US>IL>675|\n|        12|6fa993bd0e0157|     892701|      718|       1|   US>TX>612|\n|        13|7355615832b3af|    1778533|      739|       1|   US>AZ>753|\n|        14|daef797fc210a2|    1759953|      798|       3|   US>NC>560|\n|        15|24c64dc30891c0|    1777136|     1000|       2|          GB|\n|        16|30c0ad12b36375|    1727882|     1033|       1|   US>FL>561|\n|        17|c80c06d718ba65|    1667725|     1044|       2|   US>MI>540|\n|        18|eb58e66b4f6bb0|     429183|     1175|       2|   US>OR>820|\n|        19|c419799a427c72|    1155107|     1202|       3|   US>HI>744|\n|        20|650e3b5699738b|    1642724|     1282|       2|   US>MI>505|\n+----------+--------------+-----------+---------+--------+------------+\nonly showing top 20 rows\n\nroot\n |-- display_id: integer (nullable = true)\n |-- uuid: string (nullable = true)\n |-- document_id: integer (nullable = true)\n |-- timestamp: integer (nullable = true)\n |-- platform: string (nullable = true)\n |-- geo_location: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1508225729211_1315038908","id":"20171017-163940_1476109886","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7003"},{"text":"%md\n#### Let's count how many events are here in the dataset?","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Let&rsquo;s count how many events are here in the dataset?</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225729212_1313115163","id":"20171017-163942_1183395056","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7004"},{"text":"%spark2.pyspark\nevents_count = events_df.count()\nevents_count","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"23119786\n"}]},"apps":[],"jobName":"paragraph_1508225729212_1313115163","id":"20171017-163944_1885999779","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7005"},{"text":"%md\n#### Now let's find out how many distinct users appeared in this dataset?\n","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Now let&rsquo;s find out how many distinct users appeared in this dataset?</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225729213_1312730415","id":"20171017-163946_1510871105","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7006"},{"text":"%spark2.pyspark\nimport pyspark.sql.functions as F\ndistinct_events_users = events_df.agg(F.countDistinct(\"uuid\").alias('count')).collect()[0]['count']\ndistinct_events_users","dateUpdated":"2017-10-17T20:35:29+1300","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"19794678\n"}]},"apps":[],"jobName":"paragraph_1508225729213_1312730415","id":"20171017-163948_1616530613","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7007"},{"text":"%md\n#### So now, how many events each distinct user created? Let's get an average number:\n","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>So now, how many events each distinct user created? Let&rsquo;s get an average number:</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225729214_1313884661","id":"20171017-170637_776014806","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7008"},{"text":"%spark2.pyspark\navg_events_by_user = events_count / float(distinct_events_users)\navg_events_by_user\n","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1.167979898435327\n"}]},"apps":[],"jobName":"paragraph_1508225729214_1313884661","id":"20171017-170750_182535060","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7009"},{"text":"%md\n### Merge events and page_views datasets","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Merge events and page_views datasets</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225729215_1313499912","id":"20171017-170804_259346329","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7010"},{"text":"%spark2.pyspark\npage_views_df = page_views_df.withColumn('dummyPageView', F.lit(1))\nevents_df = events_df.withColumn('dummyEvent', F.lit(1))\npage_views_events_joined_by_uuid_document_df = page_views_df.alias('page_views').join(events_df.alias('events'), on=['uuid','document_id'], how='outer')\npage_view_events_matches_df = page_views_events_joined_by_uuid_document_df .filter('dummyPageView is not null and dummyEvent is not null')\npage_view_events_matches_df.show(50)","dateUpdated":"2017-10-17T20:35:29+1300","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+-----------+---------+--------+------------+--------------+-------------+----------+----------+--------+------------+----------+\n|          uuid|document_id|timestamp|platform|geo_location|traffic_source|dummyPageView|display_id| timestamp|platform|geo_location|dummyEvent|\n+--------------+-----------+---------+--------+------------+--------------+-------------+----------+----------+--------+------------+----------+\n|107d782db58ecd|      60164| 36055596|       1|   US>TX>641|             1|            1|    990347|  60990241|       1|   US>TX>641|         1|\n|10d5f6e5588450|    1767390| 62268660|       1|   US>GA>524|             1|            1|   1017278|  62268660|       1|   US>GA>524|         1|\n|11c33317b53cd9|    1796937| 57047846|       2|   US>MA>506|             1|            1|    902868|  57047846|       2|   US>MA>506|         1|\n|1243417cbf7cb1|    1772277| 81551746|       2|       CA>ON|             2|            1|   1365379|  81551746|       2|       CA>ON|         1|\n|127a1b56c1f421|      55922| 62248478|       1|   US>OK>650|             1|            1|   1016893|  62248649|       1|   US>OK>650|         1|\n|127d828ed1d984|    1729653|  4820986|       1|   US>CA>807|             1|            1|  16885407|   4820986|       1|   US>CA>807|         1|\n|129a73ae0fb56c|      60164| 43176713|       1|   US>FL>561|             1|            1|  19750009|1087003443|       1|   US>FL>530|         1|\n|13275dbf7a1757|    1061689| 33148721|       2|   US>NY>532|             1|            1|    385565|  33148721|       2|   US>NY>532|         1|\n|139473b9d2c2a9|    1784599| 43672578|       1|   US>CA>803|             1|            1|    603602|  43672578|       1|   US>CA>803|         1|\n|1440abd328bd0b|    1660738| 63656843|       1|   US>NY>501|             1|            1|   1047606|  63736615|       1|   US>NY>501|         1|\n|15744eeb0e2e09|     270496| 20239182|       1|   US>AR>734|             1|            1|   9694959| 654142432|       1|   US>AR>734|         1|\n|15744eeb0e2e09|     270496| 20239182|       1|   US>AR>734|             1|            1|   6080991| 404686569|       1|   US>AR>734|         1|\n|15744eeb0e2e09|     270496| 20239182|       1|   US>AR>734|             1|            1|  11174125| 744815346|       1|   US>AR>734|         1|\n|1708c321f8111e|    1805349| 50702913|       1|   US>NC>560|             1|            1|    761585|  50702913|       1|   US>NC>560|         1|\n|1782746a3fa0ef|    1209057| 20189520|       2|   US>CA>807|             1|            1|    189088|  20189520|       2|   US>CA>807|         1|\n|181d53328e6913|    1857590| 59992684|       1|   US>NC>550|             1|            1|    968280|  59993216|       1|   US>NC>550|         1|\n|1865d7be524eb4|    1456851| 64288998|       2|   US>FL>534|             1|            1|   1059002|  64288998|       2|   US>FL>534|         1|\n|1892ae9c0f8d63|    1867736| 65206705|       2|   US>TX>623|             3|            1|  17065276|  65206705|       2|   US>TX>623|         1|\n|19624ff0721b5d|    1839670| 46569481|       1|   US>TX>618|             1|            1|    666788|  46569481|       1|   US>TX>618|         1|\n|19bad301700c81|    1844981| 65216634|       1|   US>CA>807|             1|            1|   1077123|  65216634|       1|   US>CA>807|         1|\n|1a2beba98344b4|    1867060| 83889550|       3|   US>FL>539|             1|            1|   1405499|  83889550|       3|   US>FL>539|         1|\n|1ab008e0923c5a|    1642766| 28550886|       2|   US>OH>542|             3|            1|    298744|  28550886|       2|   US>OH>542|         1|\n|1ab17a0ddf40a0|    1409220| 79574999|       3|   US>MI>505|             1|            1|   1329621|  79574999|       3|   US>MI>505|         1|\n|1c59a11665a2b5|    1857001| 57444576|       1|   US>NY>501|             1|            1|    911812|  57444576|       1|   US>NY>501|         1|\n|1df69d3df45444|    1729653| 51056143|       1|   US>NC>567|             1|            1|    769354|  51056143|       1|   US>NC>567|         1|\n|1e631030be3463|    1826941| 46077208|       1|   US>SC>546|             1|            1|    656134|  46077355|       1|   US>SC>546|         1|\n|1f1c4b0ff9a525|      60164| 38619156|       1|   US>TX>634|             1|            1|  16504562|1100088450|       1|   US>TX>634|         1|\n|1f5e11aed3d916|     428940| 59997676|       2|          US|             2|            1|    968357|  59997676|       2|          US|         1|\n|20417c4c8d3d14|    1805659| 35813514|       1|   US>VA>511|             1|            1|    441286|  35813514|       1|   US>VA>511|         1|\n|20fb9ffc2c7669|     466260| 19425921|       1|       GB>F8|             1|            1|    182539|  19427010|       1|       GB>F8|         1|\n|215ccb19e0d167|    1314802| 43250265|       2|       AU>02|             1|            1|    594602|  43250265|       2|       AU>02|         1|\n|2222d4d815c821|        234| 72500624|       1|   US>CA>807|             1|            1|   1206398|  72501322|       1|   US>CA>807|         1|\n|222ac0aff44aee|    1500404|   588675|       1|   US>OR>820|             1|            1|      8540|    588675|       1|   US>OR>820|         1|\n|226d1f6d807852|     689432| 57056847|       2|   US>IL>602|             1|            1|   1811504| 120551199|       2|   US>IL>602|         1|\n|22b86b363dc16a|    1598402| 84964913|       2|   US>GA>524|             3|            1|   1423438|  84964913|       2|   US>GA>524|         1|\n|22ed793f121cfe|    1526190|  5273713|       1|   US>MI>505|             1|            1|     64732|   5273713|       1|   US>MI>505|         1|\n|2307eb9a4af075|    1687259| 39946022|       1|   US>IL>602|             1|            1|    526473|  39946022|       1|   US>IL>602|         1|\n|23269185d8d170|      54605| 70648310|       3|   US>VA>511|             2|            1|  17082662|  70651041|       3|   US>VA>511|         1|\n|2334a205841cda|    1865654| 61637824|       2|          US|             1|            1|   1004111|  61637824|       2|          US|         1|\n|2363e4b4fccc12|    1790442|  2392228|       2|   US>FL>571|             1|            1|     32437|   2392228|       2|   US>FL>571|         1|\n|238fd79c3ece7c|     489349| 85950850|       2|       NL>07|             2|            1|   1438704|  85950850|       2|       NL>07|         1|\n|23c28dcd1b7107|     888346| 76860277|       1|   US>MI>588|             3|            1|   1280818|  76860277|       1|   US>MI>588|         1|\n|24011b95abf53a|    1846753| 72520973|       3|   US>MD>512|             1|            1|   1206736|  72520973|       3|   US>MD>512|         1|\n|247957c49724a4|    1061689| 34260379|       1|       CA>NS|             1|            1|    408190|  34260379|       1|       CA>NS|         1|\n|24eb034ba8df7f|      25792| 49636212|       1|       CA>ON|             1|            1|  17222620| 128989400|       1|       CA>ON|         1|\n|2522b3a88ba30d|    1820427| 36289394|       1|   US>WA>819|             2|            1|    450966|  36289394|       1|   US>WA>819|         1|\n|2544a3695b4ee2|    1845034| 56811124|       2|   US>CO>751|             3|            1|    897312|  56811124|       2|   US>CO>751|         1|\n|25ea0d32c09eed|    1586626| 43259947|       1|   US>NC>560|             1|            1|    594791|  43259947|       1|   US>NC>560|         1|\n|265040ead6b6af|    1865812| 75179389|       1|   US>PA>504|             1|            1|   1251755|  75179478|       1|   US>PA>504|         1|\n|265d09f92b0a17|    1668558| 52016981|       1|   US>TX>641|             1|            1|  17014516|  52016981|       1|   US>TX>641|         1|\n+--------------+-----------+---------+--------+------------+--------------+-------------+----------+----------+--------+------------+----------+\nonly showing top 50 rows\n\n"}]},"apps":[],"jobName":"paragraph_1508225729215_1313499912","id":"20171017-171131_1897260260","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7011"},{"text":"%md\n### User Region Analysis\n","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>User Region Analysis</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225729216_1299264203","id":"20171017-171322_1273785153","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7012"},{"text":"%md\n#### We added four columns to the merged dataframe. They represent if that row belongs to a specific region user of not (Yes = 1, No = 0). We picked four countries from four regions: US from America, France from Europe, Korea from Asia, South Afria from Afria:","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>We added four columns to the merged dataframe. They represent if that row belongs to a specific region user of not (Yes = 1, No = 0). We picked four countries from four regions: US from America, France from Europe, Korea from Asia, South Afria from Afria:</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225729216_1299264203","id":"20171017-171441_2090268389","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7013"},{"text":"%spark2.pyspark\r\npage_views_geo = sqlContext.read.format(\"csv\").option(\"header\", \"true\").option(\"inferSchema\", \"true\").load(\"/user/student4/a3/page_views_sample_geo.csv\")\r\npage_views_geo.cache() # Cache page_views_geo for faster reuse\r\npage_views_geo = page_views_geo.dropna() # drop rows with missing values\r\npage_views_geo.show(20)\r\npage_views_geo.printSchema()","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+-----------+---------+--------+------------+--------------+-------+-------+-------+-------+\n|          uuid|document_id|timestamp|platform|geo_location|traffic_source|uscount|frcount|krcount|sacount|\n+--------------+-----------+---------+--------+------------+--------------+-------+-------+-------+-------+\n|1fd5f051fba643|        120| 31905835|       1|          RS|             2|      0|      0|      0|      0|\n|8557aa9004be3b|        120| 32053104|       1|       VN>44|             2|      0|      0|      0|      0|\n|c351b277a358f0|        120| 54013023|       1|       KR>12|             1|      0|      0|      1|      0|\n|8205775c5387f9|        120| 44196592|       1|       IN>16|             2|      0|      0|      0|      0|\n|9cb0ccd8458371|        120| 65817371|       1|   US>CA>807|             2|      1|      0|      0|      0|\n|2aa611f32875c7|        120| 71495491|       1|       CA>ON|             2|      0|      0|      0|      0|\n|f55a6eaf2b34ab|        120| 73309199|       1|       BR>27|             2|      0|      0|      0|      0|\n|cc01b582c8cbff|        120| 50033577|       1|       CA>BC|             2|      0|      0|      0|      0|\n|6c802978b8dd4d|        120| 66590306|       1|       CA>ON|             2|      0|      0|      0|      0|\n|f4e423314303ff|        120| 48314254|       1|   US>LA>622|             1|      1|      0|      0|      0|\n|3937372ca2709b|        120| 24360074|       1|          NO|             2|      0|      0|      0|      0|\n|31f8d101c6a851|        120| 13847456|       1|       PH>D9|             2|      0|      0|      0|      0|\n|67606983fe1acf|        984| 82129416|       2|   US>OK>671|             2|      1|      0|      0|      0|\n|3f9d5b09ac4a0a|        984| 82583638|       2|          US|             2|      1|      0|      0|      0|\n|3dd8a359aa8699|        984| 59439284|       2|   US>MD>511|             2|      1|      0|      0|      0|\n|95e966c81b9316|        984|   983791|       3|   US>AL>698|             2|      1|      0|      0|      0|\n|483cf1feb3e47c|        984| 17944009|       2|   US>MI>505|             1|      1|      0|      0|      0|\n|f7baf0caf201ca|        984| 37096677|       2|       CA>AB|             2|      0|      0|      0|      0|\n|7a408fe90c02b3|        984| 30457643|       1|          PH|             1|      0|      0|      0|      0|\n|9ee2877617838a|        984| 86093121|       3|   US>MN>613|             2|      1|      0|      0|      0|\n+--------------+-----------+---------+--------+------------+--------------+-------+-------+-------+-------+\nonly showing top 20 rows\n\nroot\n |-- uuid: string (nullable = true)\n |-- document_id: integer (nullable = true)\n |-- timestamp: integer (nullable = true)\n |-- platform: integer (nullable = true)\n |-- geo_location: string (nullable = true)\n |-- traffic_source: integer (nullable = true)\n |-- uscount: integer (nullable = true)\n |-- frcount: integer (nullable = true)\n |-- krcount: integer (nullable = true)\n |-- sacount: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1508225729217_1298879454","id":"20171017-171705_167572091","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7014"},{"text":"%spark2.pyspark\npage_views_geo_pd = page_views_geo.toPandas()","dateUpdated":"2017-10-17T20:35:29+1300","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1508225729217_1298879454","id":"20171017-171721_995630722","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7015"},{"text":"%spark2.pyspark\nprint(\"US user count\")\nprint(sum(page_views_geo_pd['uscount']))\nprint(\"French user count\")\nprint(sum(page_views_geo_pd['frcount']))\nprint(\"Korean user count\")\nprint(sum(page_views_geo_pd['krcount']))\nprint(\"South African user count\")\nprint(sum(page_views_geo_pd['sacount']))","dateUpdated":"2017-10-17T20:35:29+1300","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"US user count\n234794\nFrench user count\n213\nKorean user count\n154\nSouth African user count\n116\n"}]},"apps":[],"jobName":"paragraph_1508225729218_1300033701","id":"20171017-171808_848383109","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7016"},{"text":"%md\n#### Now let's split the regional data into different dataframes which will be easier to analyse:","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Now let&rsquo;s split the regional data into different dataframes which will be easier to analyse:</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225729218_1300033701","id":"20171017-171817_1831736796","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7017"},{"text":"%spark2.pyspark\nusclick = (page_views_geo_pd.loc[page_views_geo_pd['uscount'] == 1])\nfrclick = (page_views_geo_pd.loc[page_views_geo_pd['frcount'] == 1])\nkrclick = (page_views_geo_pd.loc[page_views_geo_pd['krcount'] == 1])\nsaclick = (page_views_geo_pd.loc[page_views_geo_pd['sacount'] == 1])","dateUpdated":"2017-10-17T20:35:29+1300","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1508225729219_1299648952","id":"20171017-172050_1937910741","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7018"},{"text":"%spark2.pyspark\nprint(\"US users platform distribution:\")\nprint(usclick['platform'].value_counts())\nprint(\"French users platform distribution:\")\nprint(frclick['platform'].value_counts())\nprint(\"Korean users platform distribution:\")\nprint(krclick['platform'].value_counts())\nprint(\"South African users platform distribution:\")\nprint(saclick['platform'].value_counts())","dateUpdated":"2017-10-17T20:35:29+1300","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"table","height":344,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"US users platform distribution:\n1    168112\n2     43973\n3     22709\nName: platform, dtype: int64\nFrench users platform distribution:\n1    144\n3     43\n2     26\nName: platform, dtype: int64\nKorean users platform distribution:\n1    130\n3     12\n2     12\nName: platform, dtype: int64\nSouth African users platform distribution:\n1    74\n2    30\n3    12\nName: platform, dtype: int64\n"}]},"apps":[],"jobName":"paragraph_1508225729220_1297725207","id":"20171017-172129_413580924","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7019"},{"text":"%spark2.pyspark\nprint(\"US users traffic source distribution:\")\nprint(usclick['traffic_source'].value_counts())\nprint(\"French users trafficsource distribution:\")\nprint(frclick['traffic_source'].value_counts())\nprint(\"Korean users traffic source distribution:\")\nprint(krclick['traffic_source'].value_counts())\nprint(\"South African users traffic source distribution:\")\nprint(saclick['traffic_source'].value_counts())","dateUpdated":"2017-10-17T20:35:29+1300","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"table","height":344,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"US users traffic source distribution:\n1    203124\n2     31258\n3       412\nName: traffic_source, dtype: int64\nFrench users trafficsource distribution:\n1    165\n2     48\nName: traffic_source, dtype: int64\nKorean users traffic source distribution:\n1    137\n2     17\nName: traffic_source, dtype: int64\nSouth African users traffic source distribution:\n1    80\n2    33\n3     3\nName: traffic_source, dtype: int64\n"}]},"apps":[],"jobName":"paragraph_1508225729220_1297725207","id":"20171017-172333_339465291","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7020"},{"text":"%spark2.pyspark\nprint(\"US users document distribution:\")\nprint(usclick['document_id'].value_counts())","dateUpdated":"2017-10-17T20:35:29+1300","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"US users document distribution:\n42744     155330\n25792      62048\n53430       3575\n87488       1171\n78535        783\n92817        694\n10653        382\n7012         369\n60040        332\n93106        296\n78886        292\n25529        264\n98692        235\n49464        214\n44063        207\n92685        204\n97486        199\n25681        185\n92119        181\n94028        174\n92747        156\n92379        146\n62908        128\n97096        120\n94084        108\n83316         96\n4491          92\n88855         92\n39193         88\n85109         84\n           ...  \n48661          3\n1253           3\n53348          3\n75896          3\n121223         3\n57177          3\n33788          3\n60951          3\n31040          3\n35846          3\n14732          3\n55796          3\n70770          3\n91463          3\n29797          2\n46550          2\n2412           2\n72562          2\n39096          2\n37063          2\n120            2\n62569          2\n14881          2\n16033          2\n25855          2\n11619          1\n63801          1\n89572          1\n56293          1\n13968          1\nName: document_id, dtype: int64\n"}]},"apps":[],"jobName":"paragraph_1508225729221_1297340459","id":"20171017-172516_426803463","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7021"},{"text":"%spark2.pyspark\nprint(\"French users document distribution:\")\nprint(frclick['document_id'].value_counts())","dateUpdated":"2017-10-17T20:35:29+1300","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"French users document distribution:\n25792     132\n42744      19\n25529       5\n86498       5\n7012        5\n25345       3\n78535       3\n53430       3\n58670       2\n48785       2\n87488       2\n37063       2\n40394       2\n95418       1\n92747       1\n14343       1\n92685       1\n1253        1\n44189       1\n39193       1\n106267      1\n47398       1\n93735       1\n24546       1\n62944       1\n78656       1\n100681      1\n68687       1\n62908       1\n105302      1\n46940       1\n92379       1\n73062       1\n85109       1\n111833      1\n81278       1\n60040       1\n79504       1\n10653       1\n40628       1\n32764       1\nName: document_id, dtype: int64\n"}]},"apps":[],"jobName":"paragraph_1508225729221_1297340459","id":"20171017-172713_1982407251","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7022"},{"text":"%spark2.pyspark\nprint(\"Korean users document distribution:\")\nprint(krclick['document_id'].value_counts())","dateUpdated":"2017-10-17T20:35:29+1300","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Korean users document distribution:\n25792     128\n42744       7\n83316       3\n7012        3\n25529       2\n87488       2\n32764       1\n53430       1\n40628       1\n82587       1\n120         1\n82529       1\n31572       1\n47625       1\n123144      1\nName: document_id, dtype: int64\n"}]},"apps":[],"jobName":"paragraph_1508225729222_1298494705","id":"20171017-173031_1934937425","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7023"},{"text":"%spark2.pyspark\nprint(\"South African users document distribution:\")\nprint(saclick['document_id'].value_counts())","dateUpdated":"2017-10-17T20:35:29+1300","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"South African users document distribution:\n25792     70\n87488      9\n106267     5\n984        3\n49464      3\n42744      3\n78535      3\n58670      2\n44063      2\n102424     2\n98692      2\n92379      1\n105951     1\n87501      1\n94028      1\n1253       1\n96232      1\n96063      1\n56046      1\n93735      1\n45221      1\n85109      1\n60040      1\nName: document_id, dtype: int64\n"}]},"apps":[],"jobName":"paragraph_1508225729222_1298494705","id":"20171017-173038_1307172853","dateCreated":"2017-10-17T20:35:29+1300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7024"},{"text":"%spark.sql\n\nselect document_id, count(document_id) counts\nfrom a3.page_views\ngroup by document_id\norder by counts desc\n","user":"student4","dateUpdated":"2017-10-17T20:38:50+1300","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"document_id\tcounts\n1179111\t26688981\n394689\t10454691\n2191\t5044391\n7054\t4996916\n38922\t4930261\n1154100\t4610780\n357569\t4046253\n1827718\t3046274\n234\t2359994\n467462\t2328065\n42744\t2301218\n300181\t2256070\n78035\t2114884\n55531\t2029869\n1986082\t1990190\n443431\t1880098\n549223\t1816978\n60948\t1753212\n2861\t1550032\n2102553\t1492549\n60164\t1484974\n788713\t1398669\n143641\t1330691\n653170\t1291204\n813837\t1256095\n2676247\t1230965\n1728498\t1184743\n25792\t1169716\n38915\t1157822\n2029088\t1111075\n619529\t1107174\n764332\t1039315\n1900279\t990131\n824710\t983677\n1493650\t932863\n1934856\t925689\n2660718\t912176\n1671959\t877229\n966187\t842699\n2822126\t837376\n2686103\t835362\n468335\t822993\n1922160\t821747\n1901763\t804981\n1666933\t800194\n157455\t793657\n55893\t786044\n1342442\t782063\n1789836\t763638\n2672759\t762018\n4099\t755581\n205688\t751473\n788705\t728425\n2150689\t705676\n75970\t703898\n1448387\t695545\n133130\t694513\n1178289\t693428\n1535449\t691961\n1788295\t679876\n2020685\t677204\n140264\t674567\n1026091\t671696\n2184969\t667051\n1506181\t653796\n1174332\t647834\n2245917\t644915\n270496\t620591\n949725\t619058\n2245558\t617314\n1097164\t617088\n839893\t608649\n2058819\t605623\n985671\t602361\n1897747\t595967\n1627236\t595726\n2027262\t593635\n464488\t587355\n1198481\t584361\n2102659\t578412\n2244543\t564628\n1889048\t562587\n2041152\t559378\n818455\t555523\n1908966\t553545\n1077294\t551818\n2791699\t551364\n225467\t550477\n2133451\t548031\n1811567\t546155\n2097694\t545973\n2006436\t545591\n86256\t543756\n2177418\t543394\n821045\t542340\n2285526\t542088\n2230337\t540591\n2380822\t538376\n2445091\t537510\n1060089\t535962\n270483\t534176\n2568767\t529909\n1146082\t528531\n1792837\t526204\n2108617\t525086\n1504456\t521645\n2662622\t520597\n2307908\t520207\n224227\t519131\n977519\t517519\n1108855\t517451\n1717049\t515979\n465809\t512759\n2726726\t509545\n65309\t505717\n2785127\t505078\n766031\t504477\n1667421\t497313\n2305575\t494170\n1899808\t492389\n1970275\t491987\n2840775\t487564\n2765199\t485018\n1756801\t477889\n2411319\t475984\n270485\t474149\n427953\t474069\n458218\t473345\n813249\t471385\n2525651\t470491\n2351959\t469907\n1647898\t464990\n542883\t464609\n2787821\t464388\n2219134\t463201\n1515072\t458504\n2048679\t457119\n1854223\t455590\n452\t450868\n2474588\t448210\n2588127\t447881\n1946446\t447253\n2405428\t446277\n371683\t446273\n2697397\t445396\n2017193\t444165\n2178705\t441960\n2105374\t441804\n867568\t441272\n2754737\t438440\n2230780\t435896\n2928185\t435283\n2325995\t433434\n1219473\t432769\n2395907\t430304\n2406459\t426699\n2131999\t426484\n2676069\t424724\n2803004\t423593\n2343003\t423274\n2965281\t422344\n270492\t417778\n1280592\t416991\n635051\t416195\n2165306\t414368\n1900651\t412747\n257628\t410508\n2862937\t409593\n972940\t406611\n986270\t406045\n285983\t405204\n2491489\t401078\n1126396\t400706\n2367739\t400619\n2873793\t398821\n2301149\t398789\n1063418\t397424\n2436405\t397126\n1027695\t396721\n1773948\t390395\n2119951\t390199\n1271578\t389290\n2142853\t389175\n2084829\t387495\n2351430\t387083\n1662353\t384233\n2575922\t384130\n1885689\t383770\n1070246\t383078\n1761248\t381826\n222720\t379384\n2399399\t379289\n141839\t378684\n1329446\t377213\n761527\t375386\n1573953\t374611\n1983049\t373905\n2270844\t373041\n65310\t373010\n2830928\t372684\n2522756\t371983\n1097167\t371193\n1897857\t369738\n2273509\t369415\n1927654\t369319\n2310086\t369316\n1525917\t369227\n2821957\t367431\n2148955\t366821\n22199\t364871\n2714621\t364599\n12\t364191\n1937441\t363773\n1934787\t360839\n1157326\t359827\n1119553\t358021\n225121\t357333\n2048731\t352349\n1805728\t352021\n1964553\t351055\n2047013\t350884\n1792944\t350589\n2150177\t350305\n2822013\t350104\n2767231\t348984\n1328897\t347110\n1775106\t346206\n2881967\t346070\n2092527\t345456\n1177576\t344938\n2854574\t342062\n1877214\t339626\n2128083\t338901\n2634491\t338398\n228443\t337618\n2267016\t335881\n2026217\t332732\n2234131\t329948\n2596198\t329501\n1998972\t327992\n916571\t327916\n1267760\t327804\n2446821\t327192\n25890\t327086\n2055146\t324161\n2717342\t323543\n2557083\t322788\n1785043\t322549\n2419288\t322309\n1061689\t322224\n2517776\t319775\n515\t317211\n1079003\t317197\n2535847\t316556\n1704938\t316252\n448345\t314800\n207127\t313704\n2963344\t312127\n2282373\t310879\n2107977\t310585\n2329906\t310512\n1808957\t309875\n1075288\t309795\n1980824\t309747\n86357\t309524\n1024333\t307731\n987989\t307648\n2313026\t307572\n1147007\t306233\n1665297\t305940\n2822081\t305570\n1922171\t304808\n1850998\t301537\n2148112\t300918\n1724094\t300626\n2525986\t300618\n1545080\t300037\n2837672\t298970\n2725681\t297685\n637429\t297436\n2037764\t297277\n1969579\t296776\n2451426\t295753\n1715558\t295619\n1142210\t295370\n1965877\t295218\n1897214\t294821\n2129730\t293890\n1694537\t292875\n2796503\t292610\n1690147\t292378\n2177775\t292249\n1683782\t292056\n2518655\t291302\n2600498\t291216\n2743625\t290422\n1118196\t290030\n2918300\t289939\n1326050\t288112\n2333442\t287843\n1772854\t286518\n2603157\t285071\n354545\t284670\n2266314\t284338\n687573\t284100\n1205772\t283946\n1077376\t283527\n1743695\t283509\n2844973\t282687\n2323522\t282654\n2280716\t282372\n1890742\t281978\n813290\t280769\n2683000\t280387\n1097710\t280163\n2313627\t279785\n2848950\t279063\n2722529\t278725\n2759962\t278190\n2307478\t276789\n2144914\t276049\n1954873\t274801\n1809496\t274761\n53419\t274027\n342970\t273898\n2693727\t272911\n1473380\t272465\n1252062\t271702\n1663165\t271061\n2417913\t268954\n2713505\t268329\n2792500\t267830\n2438447\t267436\n358570\t267384\n2103263\t266433\n930405\t266361\n1448353\t265927\n53416\t264934\n2263090\t264790\n1773554\t264608\n1833376\t264535\n1074352\t264468\n174941\t263558\n1077398\t262900\n2140502\t262644\n2868341\t261236\n1855364\t260626\n2352648\t260616\n1943295\t259763\n1971544\t258991\n1147149\t258845\n2798714\t257158\n228332\t256715\n1082545\t255756\n2684757\t255671\n152770\t255015\n1279759\t254906\n2264432\t253856\n1331473\t253620\n2198112\t253444\n1486649\t253355\n2823646\t253252\n1834023\t252927\n1832409\t252648\n1316528\t251864\n2264441\t251509\n1823665\t249934\n2712621\t249650\n2518951\t249400\n1211755\t248465\n2691468\t248432\n2446575\t247887\n959426\t247079\n2343766\t247029\n2444735\t246910\n1077407\t246852\n2010978\t245662\n137631\t245232\n1347756\t245130\n2774783\t244631\n1062077\t243626\n53356\t242600\n144036\t242083\n155881\t240584\n2027479\t240347\n2232958\t239564\n207074\t238958\n2136476\t238843\n1167667\t238458\n286427\t238341\n2110193\t238235\n1858440\t238136\n379297\t237840\n1083506\t237619\n1924594\t237513\n224784\t237472\n2628554\t236913\n1449981\t236566\n447756\t236089\n1069489\t235474\n2749008\t234656\n1446279\t234415\n1566106\t234251\n2279618\t234100\n2481254\t233542\n1489174\t233298\n1313682\t233225\n1075290\t231983\n2441224\t231664\n2429020\t231532\n1895273\t231414\n1828958\t231402\n1711582\t231206\n2288525\t230863\n2383841\t230267\n1578434\t230179\n43789\t230111\n1937724\t230091\n2185306\t229527\n1840324\t229102\n2064366\t228739\n1823586\t228175\n1909932\t227958\n2187074\t227633\n2451010\t226801\n361391\t226711\n1994929\t226418\n2002262\t226403\n2116543\t226340\n1778538\t226269\n2160375\t226101\n1842656\t226088\n1099077\t225202\n1943546\t224767\n1824031\t224487\n1943982\t223936\n2585397\t223349\n2757977\t222642\n2245999\t221750\n1148554\t221324\n985349\t221048\n2054862\t220707\n985479\t220568\n2506359\t220410\n2266330\t220302\n2092488\t220098\n2669045\t220012\n2330549\t219595\n1775096\t219179\n131750\t219115\n986538\t218712\n1077542\t218352\n2060927\t217804\n1490215\t217335\n2388488\t217216\n2037263\t216707\n2673550\t216331\n2822102\t216216\n2422192\t215906\n2822072\t215721\n1675068\t215603\n2572435\t215111\n2143876\t214940\n2398785\t214881\n1988656\t214836\n2244830\t214801\n386125\t214588\n2856016\t214269\n1514641\t214108\n2846936\t213802\n2766726\t213757\n398904\t213317\n1695543\t213098\n2806694\t212690\n2155217\t212145\n2797545\t211813\n1824802\t211636\n1171610\t211615\n2924243\t211128\n1645942\t210848\n2132178\t210500\n1340752\t210265\n723561\t210047\n1743612\t210033\n2023535\t209424\n2339329\t209268\n2247792\t209039\n2690736\t208917\n142095\t208651\n2755782\t208467\n1770030\t208139\n133529\t207963\n2121254\t207908\n2847863\t207808\n2346164\t207741\n1715349\t207206\n2120818\t206731\n1787381\t206529\n1948118\t206261\n2872870\t205974\n2788936\t205871\n270480\t205567\n144125\t205469\n2951683\t205293\n1077622\t205234\n986263\t205164\n2245505\t204899\n249013\t204822\n1899175\t204116\n2343627\t203939\n1980387\t203259\n2521116\t203230\n1880881\t203107\n2268517\t203094\n2232222\t202946\n2820957\t201354\n2167958\t201257\n2097269\t200998\n1286549\t200373\n1761783\t200012\n2434209\t199907\n1897183\t199868\n1966448\t199841\n939988\t199645\n1096954\t199216\n1291818\t199115\n1813048\t198593\n11287\t198516\n386129\t198468\n838624\t198286\n2058033\t198025\n2825757\t197818\n1580488\t197712\n2606947\t197682\n2599024\t197627\n2257223\t197445\n1077663\t197333\n935526\t197112\n2018146\t196816\n2099817\t196702\n2134656\t196408\n2519721\t196344\n2108998\t196318\n2273031\t196184\n2879534\t196083\n2791748\t196027\n2118474\t196020\n2334336\t195795\n1937836\t195455\n2017098\t194677\n1638857\t194446\n2754912\t194240\n1825523\t193952\n2676661\t193671\n2565075\t193533\n2047852\t193311\n986417\t192835\n2255024\t192816\n2022034\t192734\n2793381\t192406\n1860163\t192380\n914697\t192191\n6391\t191928\n2127730\t191891\n1270285\t191762\n266255\t191683\n2849203\t191532\n2441894\t191112\n2706496\t190648\n2726062\t190576\n2290669\t190496\n2234570\t190146\n2420801\t190130\n944633\t189920\n2521259\t189464\n2029005\t189436\n2297823\t189312\n1651264\t189255\n2748668\t189119\n2710455\t188948\n1086036\t188887\n1849650\t188702\n2295026\t188672\n2726874\t188214\n379094\t188190\n1979638\t188055\n2613115\t187907\n813222\t187852\n944629\t187723\n2637126\t187488\n2190190\t187406\n1895038\t187221\n2502364\t186970\n2347135\t186855\n39226\t186715\n2320522\t186350\n2247054\t186345\n2578995\t186068\n1489592\t186039\n1890425\t186032\n2041996\t185324\n1820005\t184735\n1770303\t184651\n1044846\t184473\n2047601\t184354\n1668477\t184154\n1743986\t183902\n1298416\t183874\n2082831\t183232\n1208936\t183228\n2694843\t183148\n1618733\t182924\n2389800\t182897\n2405911\t182727\n2258308\t182590\n1620989\t182345\n2290056\t182241\n2011231\t181873\n2759200\t181781\n2332841\t181478\n2261228\t181453\n128763\t181355\n1785066\t180899\n1489250\t180842\n53418\t180635\n1434435\t180205\n2528181\t180066\n959109\t179959\n206403\t179808\n1916421\t179787\n2483111\t179730\n1860105\t179584\n2434044\t179283\n2865548\t179259\n2671671\t179163\n1782547\t179025\n1088232\t178784\n1428819\t178474\n1134599\t178333\n2400547\t177514\n1003088\t177502\n1687259\t177423\n2246752\t177278\n2129568\t176992\n2059820\t176501\n1037508\t176181\n53425\t175929\n2654267\t175870\n842394\t175820\n1003722\t175717\n813229\t175462\n1786673\t175212\n2623120\t175058\n2889162\t175017\n2638805\t174950\n2630262\t174899\n2234632\t174848\n1534878\t174534\n2921995\t174297\n1765799\t174245\n62948\t174164\n2671556\t173750\n1788292\t173442\n2289024\t173177\n1892610\t173100\n2098849\t172744\n38775\t172226\n1148681\t172147\n2362120\t171684\n2146490\t171130\n1099497\t170903\n1958305\t170901\n2765974\t170892\n2151753\t170803\n2652509\t170781\n1330329\t170651\n2078981\t170316\n1614835\t170034\n2283468\t169804\n1567082\t169761\n907214\t169335\n2705072\t169189\n2017617\t169172\n386127\t168707\n1340847\t168637\n385721\t168453\n2968487\t168321\n161824\t167893\n1816260\t167725\n2034759\t167676\n1659447\t167663\n1586178\t167584\n2506673\t167472\n2792356\t167417\n2827190\t167144\n769899\t167100\n265354\t167009\n1446232\t166913\n2754211\t166797\n2822139\t166649\n1808961\t166566\n516107\t166018\n965334\t165739\n1256566\t165734\n1811014\t165714\n179517\t165710\n2211060\t165620\n2830961\t165584\n1489631\t165505\n2976828\t165501\n2083398\t165183\n1774106\t164959\n2240735\t164945\n2447602\t164619\n1446457\t164554\n1959571\t164267\n1023188\t164125\n2646181\t163782\n1755529\t163725\n2346210\t163568\n1840096\t163355\n1902361\t163224\n431606\t163199\n903485\t162897\n466346\t162849\n1686515\t162677\n964380\t162591\n990616\t162564\n1851567\t162553\n974315\t162436\n1582089\t162312\n1113417\t162148\n1980687\t161902\n1327252\t161874\n1714149\t161734\n2471174\t161561\n1928347\t161503\n1818283\t161440\n75976\t161095\n2139111\t161073\n2652234\t161026\n1398946\t161009\n2154865\t161001\n1876750\t160846\n1258738\t160800\n1775603\t160559\n857737\t160397\n500344\t160185\n949698\t160159\n1977319\t160128\n2532862\t159955\n2121879\t159843\n2327050\t159468\n2524321\t159407\n1461902\t159292\n1843972\t159027\n2276172\t158951\n859091\t158922\n2822315\t158852\n731005\t158836\n1921897\t158073\n2691097\t157941\n1117066\t157931\n2167092\t157472\n364356\t157458\n1839185\t157435\n2572828\t157267\n902602\t157233\n2484842\t157050\n1886718\t157042\n822645\t156991\n2872994\t156971\n2411448\t156963\n2349940\t156835\n1139808\t156615\n2121142\t156538\n642201\t156530\n2490075\t156494\n1130539\t156434\n160782\t156430\n2740129\t156410\n2015856\t156391\n267040\t156379\n1166114\t156261\n1817917\t155957\n2438962\t155876\n2388761\t155801\n2472816\t155642\n1669669\t155560\n1113514\t155364\n2085249\t155359\n1719609\t155106\n1707496\t155092\n772290\t155007\n2300857\t155006\n2128831\t154601\n1876671\t154485\n2813177\t154308\n2873861\t154104\n1949327\t153890\n1965367\t153795\n456082\t153775\n2822267\t153692\n2348878\t153671\n2103805\t153611\n2128277\t153431\n1647323\t153356\n2047901\t153316\n1853784\t153105\n2544214\t153041\n2690569\t152901\n236\t152650\n2342722\t152614\n2289349\t152439\n2212033\t152205\n1878779\t152157\n2358172\t151790\n1624154\t151729\n2047372\t151661\n1118065\t151527\n1292675\t151487\n1758922\t151315\n2035635\t151270\n1635961\t151255\n1357169\t151159\n1756992\t151127\n860902\t151113\n2442524\t151091\n2405300\t151047\n1113856\t150738\n1714625\t150575\n2613560\t150474\n1098910\t150454\n1772630\t150450\n1030092\t150436\n2117427\t150353\n2133746\t150281\n2303037\t150182\n369907\t150115\n2685902\t150093\n2427596\t150066\n1709449\t149944\n1980322\t149903\n510319\t149796\n1655097\t149728\n2091944\t149515\n2008041\t149279\n2274321\t149248\n1490228\t149134\n2497650\t149082\n1783281\t149018\n2835535\t148974\n2920140\t148870\n1624392\t148370\n1772849\t148214\n1703374\t148214\n6452\t148198\n377863\t148183\n2822666\t148078\n2037957\t148070\n2632917\t148053\n1832352\t148019\n2219949\t147593\n2260979\t147475\n2362419\t147450\n324049\t146890\n2119770\t146781\n2301802\t146758\n1454429\t146652\n370324\t146506\n136232\t146290\n2478827\t146274\n2736800\t146248\n1184645\t145983\n2841186\t145967\n1920292\t145939\n2826599\t145889\n2748466\t145737\n1389371\t145656\n2412745\t145610\n2600023\t145518\n2662689\t145471\n2376742\t145396\n1399016\t144918\n2362789\t144795\n1102225\t144770\n2804454\t144752\n225937\t144527\n2660525\t144502\n500161\t144298\n1737257\t144258\n2416646\t144230\n1446417\t144157\n299283\t143734\n1410110\t143719\n2434065\t143303\n2022191\t143058\n2019172\t143014\n2274558\t142859\n1923733\t142741\n1827232\t142701\n2091787\t142598\n1394717\t142572\n1386371\t142485\n2539108\t142481\n2693694\t142265\n2532535\t142264\n2109068\t142222\n944627\t142203\n38159\t142169\n2486055\t142053\n1108898\t142050\n2323718\t141807\n1978122\t141515\n1969138\t141493\n1185363\t141470\n2619051\t141322\n1062643\t141278\n2475312\t141209\n1840647\t141185\n1491401\t141023\n2882082\t140998\n1769195\t140977\n438834\t140926\n1917820\t140913\n2534309\t140865\n2663256\t140767\n2701940\t140663\n766465\t140577\n22308\t140518\n2727584\t140387\n2504787\t140366\n2316044\t140325\n2344884\t140268\n2835375\t140264\n1878876\t140077\n2933883\t140038\n920516\t140019\n2297272\t140015\n2410773\t139943\n1979800\t139699\n163545\t139589\n2418392\t139556\n438245\t139553\n2305496\t139516\n2310098\t139513\n2058889\t139426\n2496156\t139154\n2189971\t139080\n2836134\t138903\n1684434\t138862\n1984243\t138845\n1144291\t138828\n2717377\t138778\n666586\t138739\n1758106\t138737\n1971198\t138732\n2301265\t138610\n2494270\t138486\n2095621\t138437\n1804442\t138432\n2306659\t138160\n575206\t138073\n1185618\t137975\n2787841\t137947\n2686169\t137908\n2269108\t137883\n2317683\t137861\n1823603\t137718\n2162579\t137568\n1308703\t137555\n1928450\t137452\n673403\t137397\n2301739\t137368\n360825\t137348\n1518225\t137225\n2422968\t137192\n2442888\t137066\n1587377\t136954\n2624017\t136886\n2672276\t136828\n2844297\t136701\n2592328\t136601\n2430384\t136532\n1386698\t136440\n2653271\t136425\n1628779\t136303\n2119992\t136255\n517721\t136227\n1293187\t136200\n990700\t136169\n2129827\t136126\n2817520\t136090\n2033760\t135953\n1690149\t135945\n1783789\t135879\n1877626\t135783\n1978692\t135766\n2222341\t135714\n1914712\t135695\n<!--TABLE_COMMENT-->\n<font color=red>Results are limited by 1000.</font>"}]},"apps":[],"jobName":"paragraph_1508225729223_1298109956","id":"20171017-173048_30867462","dateCreated":"2017-10-17T20:35:29+1300","dateStarted":"2017-10-17T20:38:50+1300","dateFinished":"2017-10-17T20:42:48+1300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7025"},{"text":"%md\n##### From the dataframe we got above, it shows us the popular document which got many clicks from the users.\n\n##### Now we perform a similar action by grouping the data by its traffic source and platform, see how the original data can give us:","user":"student4","dateUpdated":"2017-10-17T20:48:38+1300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h5>From the dataframe we got above, it shows us the popular document which got many clicks from the users.</h5>\n<h5>Now we perform a similar action by grouping the data by its traffic source and platform, see how the original data can give us:</h5>\n</div>"}]},"apps":[],"jobName":"paragraph_1508225930855_898030752","id":"20171017-203850_1644628563","dateCreated":"2017-10-17T20:38:50+1300","dateStarted":"2017-10-17T20:48:38+1300","dateFinished":"2017-10-17T20:48:38+1300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7026"},{"text":"%spark.sql\n\nselect platform, count(document_id) counts\nfrom a3.page_views\ngroup by platform\norder by counts desc\n","user":"student4","dateUpdated":"2017-10-17T20:53:24+1300","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":true},"editorMode":"ace/mode/sql","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"platform\tcounts\n2\t1053365944\n1\t790149483\n3\t190760021\n"}]},"apps":[],"jobName":"paragraph_1508226518385_1809358","id":"20171017-204838_274978664","dateCreated":"2017-10-17T20:48:38+1300","dateStarted":"2017-10-17T20:53:24+1300","dateFinished":"2017-10-17T20:57:31+1300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7027"},{"text":"%spark.sql\n\nselect traffic_source, count(document_id) counts\nfrom a3.page_views\ngroup by traffic_source\norder by counts desc","user":"student4","dateUpdated":"2017-10-17T20:53:26+1300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"traffic_source\tcounts\n1\t1293550863\n3\t397590753\n2\t343133832\n"}]},"apps":[],"jobName":"paragraph_1508226532094_1644333060","id":"20171017-204852_1013526518","dateCreated":"2017-10-17T20:48:52+1300","dateStarted":"2017-10-17T20:53:26+1300","dateFinished":"2017-10-17T21:01:55+1300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7028"},{"text":"%md\n#### The result is very interesting! Different from the sample dataset, there are huge differences between 3 platforms: mobile devices has absolute advantage! 1053365944 is over 50% of the whole data! Then follows by desktop which has 790149483 views, about 40% of the whole view. Tablet get 10% which is very low comparing to other two. About traffic source, the result is very similar to the sample. Internal source is about 3 times of the other two when search and social have close results.\n","user":"student4","dateUpdated":"2017-10-17T21:04:00+1300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>The result is very interesting! Different from the sample dataset, there are huge differences between 3 platforms: mobile devices has absolute advantage! 1053365944 is over 50% of the whole data! Then follows by desktop which has 790149483 views, about 40% of the whole view. Tablet get 10% which is very low comparing to other two. About traffic source, the result is very similar to the sample. Internal source is about 3 times of the other two when search and social have close results.</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1508226806434_1734159632","id":"20171017-205326_457419596","dateCreated":"2017-10-17T20:53:26+1300","dateStarted":"2017-10-17T21:04:00+1300","dateFinished":"2017-10-17T21:04:00+1300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7029"},{"text":"%md\n","user":"student4","dateUpdated":"2017-10-17T21:04:00+1300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508227440280_-2107886522","id":"20171017-210400_1717174762","dateCreated":"2017-10-17T21:04:00+1300","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:7030"}],"name":"HadoopPartForP3_Fran&Mab","id":"2CYAZ8QZH","angularObjects":{"2CKPNJ3WM:shared_process":[],"2CHN5RPQY:shared_process":[],"2CKV7744C:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CJP44H75:shared_process":[],"2CHKSSU9F:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}